/* calcite-web - v0.8.0 - 2015-06-11
*  https://github.com/esri/calcite-web
*  Copyright (c) 2015 Environmental Systems Research Institute, Inc.
*  Apache 2.0 License */
!function(){function click(){return"click"}function addEvent(domNode,e,fn){return domNode.addEventListener?domNode.addEventListener(e,fn,!1):domNode.attachEvent?domNode.attachEvent("on"+e,fn):void 0}function removeEvent(domNode,e,fn){return domNode.removeEventListener?domNode.removeEventListener(e,fn,!1):domNode.detachEvent?domNode.detachEvent("on"+e,fn):void 0}function eventTarget(e){return e.target||e.srcElement}function preventDefault(e){return e.preventDefault?e.preventDefault():void(e.returnValue&&(e.returnValue=!1))}function stopPropagation(e){return e=e||window.event,e.stopPropagation?e.stopPropagation():void(e.cancelBubble&&(e.cancelBubble=!0))}function hasClass(domNode,className){var elementClass=" "+domNode.className+" ";return-1!==elementClass.indexOf(" "+className+" ")}function addClass(domNode,classes){classes.split(" ").forEach(function(c){hasClass(domNode,c)||(domNode.className+=" "+c)})}function removeClass(domNode,classes){var elementClass=" "+domNode.className+" ";classes.split(" ").forEach(function(c){elementClass=elementClass.replace(" "+c+" "," ")}),domNode.className=elementClass.trim()}function toggleClass(domNode,className){hasClass(domNode,className)?removeClass(domNode,className):addClass(domNode,className)}function closest(className,context){var result,current;for(current=context;current;current=current.parentNode)if(1===current.nodeType&&hasClass(current,className)){result=current;break}return current}function nodeListToArray(domNodeList){return Array.prototype.slice.call(domNodeList)}function findElements(query,domNode){var context=domNode||document,elements=context.querySelectorAll(query);return nodeListToArray(elements)}function removeActive(array){"object"==typeof array&&(array=nodeListToArray(array)),array.forEach(function(item){removeClass(item,"is-active")})}function toggleActive(array,el){var isActive=hasClass(el,"is-active");isActive?removeClass(el,"is-active"):(removeActive(array),addClass(el,"is-active"))}function init(patterns){patterns=patterns||["accordion","dropdown","drawer","expandingNav","modal","tabs","sticky"],patterns.forEach(function(pattern){calcite[pattern]()})}var calcite={version:"v0.8.0",click:click,addEvent:addEvent,removeEvent:removeEvent,eventTarget:eventTarget,preventDefault:preventDefault,stopPropagation:stopPropagation,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,closest:closest,nodeListToArray:nodeListToArray,init:init};if(calcite.accordion=function(domNode){function toggleAccordion(e){var parent=closest("accordion-section",eventTarget(e));toggleClass(parent,"is-active")}findElements(".js-accordion",domNode).forEach(function(accordion){nodeListToArray(accordion.children).forEach(function(child){addEvent(child,click(),toggleAccordion)})})},calcite.dropdown=function(domNode){function closeAllDropdowns(){removeEvent(document.body,click(),closeAllDropdowns),dropdowns.forEach(function(dropdown){removeClass(dropdown,"is-active")})}function bindToggle(toggle){addEvent(toggle,click(),function(e){preventDefault(e),stopPropagation(e);var dropdown=closest("js-dropdown",toggle);closeAllDropdowns(),addClass(dropdown,"is-active"),addEvent(document.body,click(),closeAllDropdowns)})}var toggles=findElements(".js-dropdown-toggle",domNode),dropdowns=findElements(".js-dropdown",domNode);toggles.forEach(bindToggle)},calcite.drawer=function(domNode){var toggles=findElements(".js-drawer-toggle",domNode),drawers=findElements(".js-drawer",domNode);toggles.forEach(function(toggle){addEvent(toggle,click(),function(e){preventDefault(e);var drawerId=toggle.getAttribute("data-drawer"),drawer=document.querySelector('.js-drawer[data-drawer="'+drawerId+'"');toggleActive(drawers,drawer)})}),drawers.forEach(function(drawer){addEvent(drawer,click(),function(e){hasClass(eventTarget(e),"drawer")&&toggleActive(drawers,drawer)})})},calcite.expandingNav=function(domNode){var toggles=findElements(".js-expanding-toggle",domNode),sections=(findElements(".js-expanding",domNode),document.querySelectorAll(".js-expanding-nav"));toggles.forEach(function(toggle){addEvent(toggle,click(),function(e){preventDefault(e);var sectionId=toggle.getAttribute("data-expanding-nav"),section=document.querySelector('.js-expanding-nav[data-expanding-nav="'+sectionId+'"]'),expander=closest("js-expanding",section),isOpen=hasClass(expander,"is-active"),shouldClose=hasClass(section,"is-active");toggleActive(sections,section),isOpen&&shouldClose?removeClass(expander,"is-active"):addClass(expander,"is-active")})})},calcite.modal=function(domNode){var toggles=findElements(".js-modal-toggle",domNode),modals=findElements(".js-modal",domNode);toggles.forEach(function(toggle){addEvent(toggle,click(),function(e){preventDefault(e);var modal,modalId=toggle.getAttribute("data-modal");modal=modalId?document.querySelector('.js-modal[data-modal="'+modalId+'"'):closest("js-modal",toggle),toggleActive(modals,modal)})}),modals.forEach(function(modal){addEvent(modal,click(),function(e){stopPropagation(e),eventTarget(e)===modal&&toggleActive(modals,modal)})})},calcite.tabs=function(domNode){function switchTab(e){preventDefault(e);var tab=closest("js-tab",eventTarget(e)),tabGroup=closest("js-tab-group",tab),tabs=tabGroup.querySelectorAll(".js-tab"),contents=tabGroup.querySelectorAll(".js-tab-section"),index=nodeListToArray(tabs).indexOf(tab);removeActive(tabs),removeActive(contents),addClass(tab,"is-active"),addClass(contents[index],"is-active")}var tabs=findElements(".js-tab",domNode),tabGroups=findElements(".js-tab-group",domNode);tabGroups.forEach(function(tab){for(var tabsInGroup=tab.querySelectorAll(".js-tab"),percent=100/tabsInGroup.length,i=0;i<tabsInGroup.length;i++)tabsInGroup[i].style.maxWidth=percent+"%"}),tabs.forEach(function(tab){addEvent(tab,click(),switchTab)})},calcite.sticky=function(){function handleScroll(item,offset){var el=item.element,parent=el.parentNode,distance=item.top-offset,dataTop=el.getAttribute("data-top");1>distance&&!item.active?(item.shim.style.visiblity="hidden",parent.insertBefore(item.shim,el),addClass(el,"is-sticky"),item.active=!0,el.style.top=dataTop+"px"):item.active&&offset<item.top&&(parent.removeChild(item.shim),removeClass(el,"is-sticky"),el.style.top=null,item.active=!1)}var elements=findElements(".js-sticky"),stickies=elements.map(function(el){var offset=el.offsetTop,dataTop=el.getAttribute("data-top")||0;return{active:!1,top:offset-parseInt(dataTop,0),shim:el.cloneNode("deep"),element:el}});addEvent(window,"scroll",function(){var offset=window.pageYOffset;stickies.forEach(function(sticky){handleScroll(sticky,offset)})})},"function"==typeof define&&define.amd)define(function(){return calcite});else if("object"==typeof exports)module.exports=calcite;else{var oldCalcite=window.calcite;calcite.noConflict=function(){return window.calcite=oldCalcite,this},window.calcite=calcite}}();