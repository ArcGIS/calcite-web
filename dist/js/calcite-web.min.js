/*!
 * Calcite Web - Calcite Design Components in CSS, JS and HTML
 * @version v1.2.0
 * @license Apache-2.0
 * @copyright 2018 Esri
 * @link https://github.com/Esri/calcite-web
 */(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b():'function'==typeof define&&define.amd?define(b):a.calcite=b()})(this,function(){'use strict';function a(a,b){var c;for(c=b;c;c=c.parentNode){var d=c&&c.getAttribute&&c.getAttribute('class')||'',e=new RegExp('(\\s|^)'+a+'(\\s|$)').test(d);if(1===c.nodeType&&e)break}return c}function b(a){return Array.isArray(a)?a:Array.prototype.slice.call(a)}function c(a,c){var d=c||document,e=d.querySelectorAll(a);return b(e)}function d(a,b){return new RegExp('(\\s|^)'+b+'(\\s|$)').test(a.getAttribute('class'))}function e(a,b){b.split(' ').forEach(function(b){if(!d(a,b)){var c=a.getAttribute('class')||'';a.setAttribute('class',c+' '+b)}})}function f(a,b){b.split(' ').forEach(function(b){var c=(a.getAttribute('class')||'').replace(new RegExp('(\\s|^)'+b+'(\\s|$)','g'),'$2');d(a,b)&&a.setAttribute('class',c)})}function g(a,b){d(a,b)?f(a,b):e(a,b)}function h(a){a=b(a),a.forEach(function(a){f(a,'is-active')})}function i(a,b){h(a),e(b,'is-active')}function j(a){if(a){var b=a.getAttribute('aria-expanded');b?a.removeAttribute('aria-expanded'):a.setAttribute('aria-expanded','true')}}function k(){return'click'}function l(a,b,c){if(a.addEventListener)return a.addEventListener(b,c,!1);return a.attachEvent?a.attachEvent('on'+b,c):void 0}function m(a,b,c){if(a.removeEventListener)return a.removeEventListener(b,c,!1);return a.detachEvent?a.detachEvent('on'+b,c):void 0}function n(a){return a.target||a.srcElement}function o(a){return a.preventDefault?a.preventDefault():void(a.returnValue&&(a.returnValue=!1))}function p(a){return a=a||window.event,a.stopPropagation?a.stopPropagation():void(a.cancelBubble&&(a.cancelBubble=!0))}function q(){}function r(a){for(var b='',c=0;c<a;c++)b+=(0|65536*(1+Math.random())).toString(16).substring(1);return b}function s(a){if(!a)throw new TypeError('Invalid argument `value` has no value.');this.value=s.EMPTY,a&&a instanceof s?this.value=a.toString():a&&'[object String]'===Object.prototype.toString.call(a)&&s.isGuid(a)&&(this.value=a),this.equals=function(a){return s.isGuid(a)&&this.value===a},this.isEmpty=function(){return this.value===s.EMPTY},this.toString=function(){return this.value},this.toJSON=function(){return this.value}}function t(b){p(b);var c=a('accordion-section',n(b));P.emit('accordion:toggle',{node:c})}function u(a){g(a.node,'is-active');var b=a.node.querySelector('.accordion-title');j(b)}function v(a){13===a.keyCode&&d(n(a),'accordion-title')&&t(a)}function w(a){var b=c('.js-accordion');a?x(a.node):b.forEach(function(a){x(a)})}function x(a){a.setAttribute('aria-live','polite'),a.setAttribute('role','tablist'),b(a.children).forEach(function(a){var b=a.querySelector('.accordion-title'),c=a.querySelector('.accordion-content'),e=c.id||s.raw();c.id=e,b.setAttribute('role','tab'),b.setAttribute('tabindex','0'),b.setAttribute('aria-controls',e),d(a,'is-active')&&b.setAttribute('aria-expanded','true');var f=!1;O.accordions.forEach(function(a){a.target===b&&a.event===k()&&a.fn===t&&(f=!0)}),f||(O.accordions.push({target:b,event:k(),fn:t}),O.accordions.push({target:a,event:'keyup',fn:v}),l(b,k(),t),l(a,'keyup',v))})}function y(){P.on('accordion:bind',w),P.on('accordion:toggle',u),R=!0}function z(){R||y(),P.emit('accordion:bind')}function A(){m(document.body,k(),A),c('.js-dropdown').forEach(function(a){f(a,'is-active')}),c('.js-dropdown-toggle').forEach(function(a){a.setAttribute('aria-expanded','false')}),m(document,'keydown',D),m(document.body,'focusin',B)}function B(b){b.target&&!a('js-dropdown',b.target)&&P.emit('dropdown:close')}function C(a){if(a){var b=d(a.node,'is-active');P.emit('dropdown:close'),b||(e(a.node,'is-active'),a.target&&a.target.setAttribute('aria-expanded','true'),l(document,'keydown',D)),d(a.node,'is-active')&&(l(document.body,k(),A),l(document.body,'focusin',B))}}function D(a){40===a.keyCode|38===a.keyCode&&a.preventDefault()}function E(){var a=c('.js-dropdown-toggle');a.forEach(function(a){var b=!1;O.dropdowns.forEach(function(c){c.target===a&&c.event===k()&&c.fn===J&&(b=!0)}),b||(O.dropdowns.push({target:a,event:k(),fn:J}),l(a,k(),J))})}function F(){var a=document.querySelector('.js-dropdown.is-active');return!!a&&a}function G(a){var b=document.activeElement,c=a.links.indexOf(b);-1===c?a.forward?c=0:c=a.links.length-1:a.forward?(c+=1,c===a.links.length&&(c=0)):(c-=1,-1==c&&(c=a.links.length-1)),a.links[c].focus()}function H(){var a=F();if(a){var b=c('.dropdown-link',a);P.emit('dropdown:focus',{links:b,forward:!0})}}function I(){var a=F();if(a){var b=c('.dropdown-link',a);P.emit('dropdown:focus',{links:b,forward:!1})}}function J(b){o(b),p(b);var c=a('js-dropdown',b.target);P.emit('dropdown:toggle',{node:c,target:b.target})}function K(){P.on('dropdown:toggle',C),P.on('dropdown:close',A),P.on('keyboard:escape',A),P.on('keyboard:arrow:down',H),P.on('keyboard:arrow:up',I),P.on('dropdown:focus',G),S=!0}function L(){S||K(),E()}function M(){function a(a){var b=s.raw();a.setAttribute('data-sticky-id',b);var c=a.parentNode,d=a.cloneNode('deep');e(d,'js-shim'),f(d,'js-sticky'),d.setAttribute('data-sticky-id',b),d.style.visibility='hidden',d.style.display='none',c.insertBefore(d,a)}P.on('scrolling:at',function(a){g.forEach(function(b){var c=b.element;if(d(b.element,'is-sticky')){var e=b.element.getAttribute('data-sticky-id');c=document.querySelector('.js-shim[data-sticky-id="'+e+'"]')}if(c){var f=c.getAttribute('data-top')||0;b.top=c.offsetTop-parseInt(f,0)}b.top<a?P.emit('sticky:stick',b):P.emit('sticky:unstick',b)})}),P.on('sticky:stick',function(a){var b=a.element.getAttribute('data-sticky-id'),c=document.querySelector('.js-shim[data-sticky-id="'+b+'"]');b&&c&&(e(a.element,'is-sticky'),c.style.display='')}),P.on('sticky:unstick',function(a){var b=a.element.getAttribute('data-sticky-id'),c=document.querySelector('.js-shim[data-sticky-id="'+b+'"]');b&&c&&(f(a.element,'is-sticky'),c.style.display='none')});var b=c('.js-sticky'),g=b.map(function(b){var c=b.offsetTop,d=b.getAttribute('data-top')||0;b.style.top=d+'px';var e=b.getAttribute('data-sticky-id');return e||a(b),{top:c-parseInt(d,0),element:b}})}function N(){function f(a){var b=a.getAttribute('data-tab');if(b)return b;var c=s.raw();return a.setAttribute('data-tab',c),c}function g(b){var c=b.target;d(c,'js-tab')||(c=b.currentTarget);var e=a('js-tab-group',c),g=f(e);return{parent:e,id:g,active:c}}function e(a){a.preventDefault();var b=g(a);P.emit('tabs:active',b)}function h(a){var c=g(a);if((13===a.keyCode||32===a.keyCode)&&(a.preventDefault(),P.emit('tabs:active',c)),39===a.keyCode||37===a.keyCode){var e=b(c.parent.querySelectorAll('.js-tab')),f=e.indexOf(document.activeElement);if(-1<f&&d(document.activeElement,'js-tab')){var h=e[f+1]||e[0],i=e[f-1]||e[e.length-1],j=39===a.keyCode?h:i;j.focus()}}}P.on('tabs:bind',function(){var a=c('.js-tab'),b=c('.js-tab-group'),g=c('.js-tab-section');b.forEach(function(a){a.setAttribute('aria-live','polite'),f(a),a.children[0].setAttribute('role','tablist');for(var b=a.querySelectorAll('.js-tab'),c=100/b.length,d=0;d<b.length;d++)b[d].style.maxWidth=c+'%'}),a.forEach(function(a){a.setAttribute('aria-expanded','false'),a.setAttribute('role','tab'),a.setAttribute('tabindex','0'),l(a,k(),e),l(a,'keydown',h)}),g.forEach(function(a){a.setAttribute('role','tabpanel');var b=d(a,'is-active');b?a.setAttribute('aria-expanded',!0):a.setAttribute('aria-expanded',!1)})}),P.on('tabs:active',function(a){var c=a.parent,d=b(c.querySelectorAll('.js-tab')),e=a.active,f=b(c.querySelectorAll('.js-tab-section')),g=d.indexOf(e),h=f[g];d.forEach(function(a){a.setAttribute('aria-expanded',!1)}),e.setAttribute('aria-expanded',!0),i(d,e),f.forEach(function(a){a.setAttribute('aria-expanded',!1)}),h.setAttribute('aria-expanded',!0),i(f,h),e.focus()}),P.emit('tabs:bind')}var O={dropdowns:[],accordions:[],modals:[]};q.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){function d(){e.off(a,d),b.apply(c,arguments)}var e=this;return d._=b,this.on(a,d,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;f<g;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}};var P=new q,Q=/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/i;s.EMPTY='00000000-0000-0000-0000-000000000000',s.isGuid=function(a){return a&&(a instanceof s||Q.test(a.toString()))},s.create=function(){return new s([r(2),r(1),r(1),r(1),r(3)].join('-'))},s.raw=function(){return[r(2),r(1),r(1),r(1),r(3)].join('-')};var R=!1,S=!1;l(document,'keyup',function(a){27===a.keyCode?P.emit('keyboard:escape'):13===a.keyCode?P.emit('keyboard:return'):32===a.keyCode?P.emit('keyboard:space'):38===a.keyCode?P.emit('keyboard:arrow:up'):40===a.keyCode?P.emit('keyboard:arrow:down'):37===a.keyCode?P.emit('keyboard:arrow:left'):39===a.keyCode&&P.emit('keyboard:arrow:right')}),l(window,'scroll',function(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)},f}(function(){P.emit('scrolling:at',window.pageYOffset)},100));return{bus:P,accordion:z,dropdown:L,sticky:M,tabs:N,init:function(){[z,L,M,N].forEach(function(a){a()})}}});
