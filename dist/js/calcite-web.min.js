/* calcite-web - v0.1.1 - 2015-04-07
*  https://github.com/esri/calcite-web
*  Copyright (c) 2015 Environmental Systems Research Institute, Inc.
*  Apache 2.0 License */
!function(){function findElements(className){var elements=document.querySelectorAll(className);return elements.length?calcite.dom.nodeListToArray(elements):!1}function removeActive(array){"object"==typeof array&&(array=calcite.dom.nodeListToArray(array)),array.forEach(function(item){calcite.dom.removeClass(item,"is-active")})}function toggleActive(array,el){var isActive=calcite.dom.hasClass(el,"is-active");isActive?calcite.dom.removeClass(el,"is-active"):(removeActive(array),calcite.dom.addClass(el,"is-active"))}function expose(){var oldCalcite=window.calcite;calcite.noConflict=function(){return window.calcite=oldCalcite,this},window.calcite=calcite}var calcite={version:"0.0.9"};calcite.dom={},calcite.dom.event=function(){return"click"},calcite.dom.addEvent=function(domNode,event,fn){return domNode.addEventListener?domNode.addEventListener(event,fn,!1):domNode.attachEvent?domNode.attachEvent("on"+event,fn):void 0},calcite.dom.removeEvent=function(domNode,event,fn){return domNode.removeEventListener?domNode.removeEventListener(event,fn,!1):domNode.detachEvent?domNode.detachEvent("on"+event,fn):void 0},calcite.dom.eventTarget=function(event){return event.target?event.target?event.target:void 0:event.srcElement},calcite.dom.preventDefault=function(event){return event.preventDefault?event.preventDefault():void(event.returnValue&&(event.returnValue=!1))},calcite.dom.stopPropagation=function(event){return event=event||window.event,event.stopPropagation?event.stopPropagation():void(event.cancelBubble&&(event.cancelBubble=!0))},calcite.dom.hasClass=function(domNode,className){var exp=new RegExp(" "+className+" ");return exp.test(" "+domNode.className+" ")?!0:!1},calcite.dom.addClass=function(domNode,classes){classes=classes.split(" ");for(var i=0;i<classes.length;i++)calcite.dom.hasClass(domNode,classes[i])||(domNode.className+=" "+classes[i])},calcite.dom.removeClass=function(domNode,classes){classes=classes.split(" ");for(var i=0;i<classes.length;i++){var newClass=" "+domNode.className.replace(/[\t\r\n]/g," ")+" ";if(calcite.dom.hasClass(domNode,classes[i])){for(;newClass.indexOf(" "+classes[i]+" ")>=0;)newClass=newClass.replace(" "+classes[i]+" "," ");domNode.className=newClass.replace(/^\s+|\s+$/g,"")}}},calcite.dom.closest=function(className,context){var result,current;for(current=context;current;current=current.parentNode)if(1===current.nodeType&&calcite.dom.hasClass(current,className)){result=current;break}return current},calcite.dom.getAttr=function(domNode,attr){if(domNode.getAttribute)return domNode.getAttribute(attr);for(var result,attrs=domNode.attributes,i=0;i<attrs.length;i++)attrs[i].nodeName===attr&&(result=attrs[i].nodeValue);return result},calcite.dom.nodeListToArray=function(domNodeList){for(var array=[],i=0;i<domNodeList.length;i++)array.push(domNodeList[i]);return array},calcite.arr={},calcite.arr.indexOf=function(obj,arr,offset){var i=offset||0;if(arr.indexOf)return arr.indexOf(obj,i);for(i;i<arr.length;i++)if(arr[i]===obj)return i;return-1},calcite.browser={},calcite.browser.isTouch=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints>0?!0:!1},calcite.accordion=function(){function toggleAccordion(event){var parent=calcite.dom.closest("accordion-section",calcite.dom.eventTarget(event));calcite.dom.hasClass(parent,"is-active")?calcite.dom.removeClass(parent,"is-active"):calcite.dom.addClass(parent,"is-active")}var accordions=findElements(".js-accordion");if(accordions)for(var i=0;i<accordions.length;i++)for(var children=accordions[i].children,j=0;j<children.length;j++)calcite.dom.addEvent(children[j],calcite.dom.event(),toggleAccordion)},calcite.carousel=function(){function toggleSlide(e){calcite.dom.preventDefault(e);var link=calcite.dom.eventTarget(e),index=calcite.dom.getAttr(link,"data-slide"),carousel=calcite.dom.closest("carousel",link),current=carousel.querySelectorAll(".carousel-slide.is-active")[0],slides=carousel.querySelectorAll(".carousel-slide"),wrapper=carousel.querySelectorAll(".carousel-slides")[0];"prev"==index?(index=calcite.arr.indexOf(current,slides),0===index&&(index=1)):"next"==index&&(index=calcite.arr.indexOf(current,slides)+2,index>slides.length&&(index=slides.length)),calcite.dom.removeClass(carousel,"is-first-slide is-last-slide"),index==slides.length&&calcite.dom.addClass(carousel,"is-last-slide"),1==index&&calcite.dom.addClass(carousel,"is-first-slide"),removeActive(slides),calcite.dom.addClass(slides[index-1],"is-active");var offset=(index-1)/slides.length*-100+"%";wrapper.style.transform="translate3d("+offset+",0,0)"}var carousels=findElements(".js-carousel");if(carousels)for(var i=0;i<carousels.length;i++){var carousel=carousels[i],wrapper=carousel.querySelectorAll(".carousel-slides")[0],slides=carousel.querySelectorAll(".carousel-slide"),toggles=calcite.dom.nodeListToArray(carousel.querySelectorAll(".js-carousel-link"));wrapper.style.width=100*slides.length+"%",calcite.dom.addClass(slides[0],"is-active"),calcite.dom.addClass(carousel,"is-first-slide");for(var k=0;k<slides.length;k++)slides[k].style.width=100/slides.length+"%";for(var j=0;j<toggles.length;j++)calcite.dom.addEvent(toggles[j],calcite.dom.event(),toggleSlide)}},calcite.dropdown=function(){function closeAllDropdowns(){for(var i=0;i<dropdowns.length;i++)calcite.dom.removeClass(dropdowns[i],"is-active")}function toggleDropdown(dropdown){var isActive=calcite.dom.hasClass(dropdown,"is-active");isActive?calcite.dom.removeClass(dropdown,"is-active"):(calcite.dom.stopPropagation(),closeAllDropdowns(),calcite.dom.addClass(dropdown,"is-active"),calcite.dom.addEvent(document.body,calcite.dom.event(),function(){closeAllDropdowns()}))}function bindDropdown(toggle){calcite.dom.addEvent(toggle,calcite.dom.event(),function(event){calcite.dom.preventDefault(event);var dropdown=calcite.dom.closest("js-dropdown",toggle);toggleDropdown(dropdown)})}var toggles=findElements(".js-dropdown-toggle"),dropdowns=findElements(".js-dropdown");if(dropdowns)for(var i=0;i<toggles.length;i++)bindDropdown(toggles[i])},calcite.drawer=function(){function bindToggle(toggle){calcite.dom.addEvent(toggle,calcite.dom.event(),function(event){calcite.dom.preventDefault(event);for(var target=calcite.dom.getAttr(toggle,"data-drawer"),i=0;i<drawers.length;i++){var drawer=drawers[i],isTarget=calcite.dom.getAttr(drawers[i],"data-drawer");target==isTarget&&toggleActive(drawers,drawer)}})}function bindDrawer(drawer){calcite.dom.addEvent(drawer,calcite.dom.event(),function(){toggleActive(drawers,drawer)})}var toggles=findElements(".js-drawer-toggle"),drawers=findElements(".js-drawer");if(drawers){for(var i=0;i<toggles.length;i++)bindToggle(toggles[i]);for(var j=0;j<drawers.length;j++)bindDrawer(drawers[j])}},calcite.expandingNav=function(){function bindToggle(toggle){calcite.dom.addEvent(toggle,calcite.dom.event(),function(event){calcite.dom.preventDefault(event);var sectionName=calcite.dom.getAttr(toggle,"data-expanding-nav"),sections=document.querySelectorAll(".js-expanding-nav"),section=document.querySelectorAll('.js-expanding-nav[data-expanding-nav="'+sectionName+'"]')[0],expander=calcite.dom.closest("js-expanding",section),isOpen=calcite.dom.hasClass(expander,"is-active"),shouldClose=calcite.dom.hasClass(section,"is-active");isOpen?(shouldClose&&calcite.dom.removeClass(expander,"is-active"),toggleActive(sections,section)):(toggleActive(sections,section),calcite.dom.addClass(expander,"is-active"))})}var toggles=findElements(".js-expanding-toggle"),expanders=findElements(".js-expanding");if(expanders)for(var i=0;i<toggles.length;i++)bindToggle(toggles[i])},calcite.modal=function(){function bindToggle(toggle){calcite.dom.addEvent(toggle,calcite.dom.event(),function(event){calcite.dom.preventDefault(event);for(var target=calcite.dom.getAttr(toggle,"data-modal"),i=0;i<modals.length;i++){var modal=modals[i],isTarget=calcite.dom.getAttr(modals[i],"data-modal");target==isTarget&&toggleActive(modals,modal)}})}function bindModal(modal){calcite.dom.addEvent(modal,calcite.dom.event(),function(event){calcite.dom.preventDefault(event),toggleActive(modals,modal)})}var toggles=findElements(".js-modal-toggle"),modals=findElements(".js-modal");if(modals){for(var i=0;i<toggles.length;i++)bindToggle(toggles[i]);for(var j=0;j<modals.length;j++)bindModal(modals[j])}},calcite.tabs=function(){function switchTab(event){calcite.dom.preventDefault(event);var tab=calcite.dom.closest("js-tab",calcite.dom.eventTarget(event)),tabGroup=calcite.dom.closest("js-tab-group",tab),tabs=tabGroup.querySelectorAll(".js-tab"),contents=tabGroup.querySelectorAll(".js-tab-section"),index=calcite.arr.indexOf(tab,tabs);removeActive(tabs),removeActive(contents),calcite.dom.addClass(tab,"is-active"),calcite.dom.addClass(contents[index],"is-active")}var tabs=findElements(".js-tab"),tabGroups=findElements(".js-tab-group");if(tabs){for(var j=0;j<tabGroups.length;j++)for(var tabsInGroup=tabGroups[j].querySelectorAll(".js-tab"),percent=100/tabsInGroup.length,k=0;k<tabsInGroup.length;k++)tabsInGroup[k].style.maxWidth=percent+"%";for(var i=0;i<tabs.length;i++)calcite.dom.addEvent(tabs[i],calcite.dom.event(),switchTab)}},calcite.sticky=function(){function handleScroll(item,offset){var elem=item.element,parent=elem.parentNode,distance=item.top-offset,dataTop=calcite.dom.getAttr(el,"data-top");1>distance&&!item.active?(item.shim.style.visiblity="hidden",parent.insertBefore(item.shim,elem),calcite.dom.addClass(elem,"is-sticky"),item.active=!0,elem.style.top=dataTop+"px"):item.active&&offset<item.top&&(parent.removeChild(item.shim),calcite.dom.removeClass(elem,"is-sticky"),elem.style.top=null,item.active=!1)}var elements=findElements(".js-sticky");if(elements){for(var stickies=[],i=0;i<elements.length;i++){var el=elements[i],top=el.offsetTop,dataTop=calcite.dom.getAttr(el,"data-top");dataTop&&(top-=parseInt(dataTop,0)),stickies.push({active:!1,top:top,shim:el.cloneNode("deep"),element:el})}calcite.dom.addEvent(window,"scroll",function(){for(var offset=window.pageYOffset,i=0;i<stickies.length;i++)handleScroll(stickies[i],offset)})}},calcite.init=function(patterns){if(patterns)for(var i=0;i<patterns.length;i++)calcite[patterns[i]]();else calcite.modal(),calcite.dropdown(),calcite.drawer(),calcite.expandingNav(),calcite.tabs(),calcite.accordion(),calcite.carousel(),calcite.sticky();calcite.browser.isTouch()&&calcite.dom.addClass(document.body,"calcite-touch")},expose()}();